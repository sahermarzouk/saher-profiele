<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Saher Portfolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#0f172a,#020617 55%,#000 100%);
      color:#e5e7eb;
      min-height:100vh;
    }
    a{color:inherit;text-decoration:none}
    .page{
      max-width:1100px;
      margin:0 auto;
      padding:24px 16px 40px;
    }
    .card{
      border-radius:24px;
      border:1px solid rgba(148,163,184,0.35);
      background:rgba(15,23,42,0.94);
      box-shadow:0 20px 60px rgba(0,0,0,0.8);
      padding:24px;
    }
    .header-row{
      display:flex;
      flex-wrap:wrap;
      gap:24px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:20px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.9);
      color:#bfdbfe;
    }
    .name{
      font-size:26px;
      font-weight:700;
      letter-spacing:0.02em;
    }
    .title{
      font-size:15px;
      color:#9ca3af;
      margin-top:4px;
    }
    .about{
      margin-top:12px;
      font-size:14px;
      color:#e5e7eb;
      line-height:1.6;
    }
    .about p{margin-bottom:4px;}
    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:16px;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:8px 16px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-size:14px;
      font-weight:500;
      transition:all 0.18s ease;
    }
    .btn-primary{
      background:linear-gradient(120deg,#38bdf8,#22c55e);
      color:#02131d;
      box-shadow:0 12px 30px rgba(34,197,94,0.4);
    }
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 16px 40px rgba(34,197,94,0.55);}
    .btn-ghost{
      background:transparent;
      border:1px solid rgba(148,163,184,0.6);
      color:#e5e7eb;
    }
    .btn-ghost:hover{background:rgba(15,23,42,0.9);}
    .right-col{
      text-align:center;
      flex:0 0 260px;
    }
    .avatar-wrap{
      width:210px;
      height:210px;
      margin:0 auto 12px;
      border-radius:50%;
      padding:6px;
      background:
        radial-gradient(circle at 0% 0%,rgba(56,189,248,0.25),transparent 60%),
        radial-gradient(circle at 100% 100%,rgba(34,197,94,0.25),transparent 55%),
        radial-gradient(circle at center,rgba(15,23,42,1),rgba(15,23,42,1));
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .avatar{
      width:100%;
      height:100%;
      border-radius:50%;
      overflow:hidden;
      border:3px solid rgba(248,250,252,0.9);
      background:#020617;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:52px;
      font-weight:700;
    }
    .avatar img{
      width:100%;
      height:100%;
      object-fit:cover;
      object-position:top center;
      display:block;
    }
    .meta-line{
      font-size:13px;
      color:#cbd5f5;
      margin-top:4px;
    }
    .chip-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:8px;
      justify-content:center;
    }
    .chip{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.6);
      color:#e5e7eb;
    }
    .sections{
      margin-top:20px;
      display:grid;
      grid-template-columns:minmax(0,2fr) minmax(0,1.3fr);
      gap:16px;
    }
    @media(max-width:840px){
      .header-row{flex-direction:column;align-items:flex-start;}
      .right-col{align-self:center;}
      .sections{grid-template-columns:minmax(0,1fr);}
    }
    .section-card{
      border-radius:20px;
      border:1px solid rgba(148,163,184,0.45);
      background:rgba(15,23,42,0.9);
      padding:16px 18px;
      margin-bottom:12px;
    }
    .section-title{
      font-size:15px;
      font-weight:600;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .section-title span.small{
      font-size:12px;
      color:#9ca3af;
      font-weight:400;
    }
    .tag-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .tag{
      font-size:11px;
      padding:3px 9px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.55);
    }
    .list-item{
      font-size:13px;
      margin-bottom:6px;
      color:#e5e7eb;
    }
    .list-item span.label{
      font-weight:600;
    }
    .link{
      font-size:12px;
      color:#93c5fd;
      text-decoration:underline;
      margin-left:6px;
    }
    .lang-toggle{
      display:inline-flex;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      overflow:hidden;
      font-size:11px;
    }
    .lang-toggle button{
      background:transparent;
      border:none;
      padding:4px 10px;
      cursor:pointer;
      color:#9ca3af;
    }
    .lang-toggle button.active{
      background:rgba(148,163,184,0.2);
      color:#e5e7eb;
    }
    .footer{
      margin-top:16px;
      font-size:11px;
      color:#9ca3af;
      text-align:center;
    }
    /* ADMIN */
    #adminView{
      display:none;
    }
    .admin-wrap{
      max-width:1100px;
      margin:0 auto;
      padding:24px 16px 40px;
    }
    .admin-grid{
      display:grid;
      grid-template-columns:minmax(0,1.3fr) minmax(0,1fr);
      gap:16px;
    }
    @media(max-width:920px){
      .admin-grid{grid-template-columns:minmax(0,1fr);}
    }
    .field{
      margin-bottom:10px;
    }
    .field label{
      font-size:12px;
      color:#9ca3af;
      display:block;
      margin-bottom:4px;
    }
    .field input,.field textarea{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.7);
      background:rgba(15,23,42,0.9);
      color:#e5e7eb;
      padding:7px 9px;
      font-size:13px;
      outline:none;
    }
    .field textarea{min-height:80px;resize:vertical;}
    .note{
      font-size:11px;
      color:#9ca3af;
      margin-top:4px;
    }
    .danger{
      color:#fca5a5;
      font-size:12px;
      margin-top:6px;
    }
    .admin-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:14px;
    }
    .badge{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.9);
    }
    .login-box{
      max-width:400px;
      margin:40px auto;
      text-align:center;
    }
    .login-box h2{margin-bottom:10px;font-size:20px;}
    .login-box input{
      width:100%;
      margin-top:10px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.95);
      color:#e5e7eb;
      outline:none;
      font-size:13px;
    }
    .login-error{
      color:#fecaca;
      font-size:12px;
      margin-top:6px;
    }
  </style>
</head>
<body>
  <!-- PUBLIC VIEW -->
  <div id="profileView" class="page">
    <div class="card">
      <div class="header-row">
        <div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
            <div class="pill">
              <span style="width:6px;height:6px;border-radius:999px;background:#22c55e;"></span>
              <span id="roleLabel">Telecommunications & Networks</span>
            </div>
            <div class="lang-toggle">
              <button id="btnLangEn" class="active">EN</button>
              <button id="btnLangAr">AR</button>
            </div>
          </div>
          <div class="name" id="nameText">Saher Ehab Ahmed Marzouk</div>
          <div class="title" id="titleText">Telecommunications and Networks Engineer</div>
          <div class="about" id="aboutText">
            <!-- filled by JS -->
          </div>
          <div class="btn-row">
            <button class="btn btn-primary" id="btnCv">Download CV</button>
            <button class="btn btn-ghost" id="btnContactScroll">Contact</button>
          </div>
        </div>
        <div class="right-col">
          <div class="avatar-wrap">
            <div class="avatar">
              <img id="profilePhoto" src="profile.jpg" alt="Profile" onerror="this.style.display='none';this.parentNode.textContent='SM';" />
            </div>
          </div>
          <div class="meta-line" id="emailText">sahermarzouk655@gmail.com</div>
          <div class="meta-line" id="phoneText"></div>
          <div class="chip-row">
            <div class="chip">Networking</div>
            <div class="chip">Cybersecurity</div>
            <div class="chip">Programming</div>
          </div>
        </div>
      </div>

      <div class="sections">
        <div>
          <div class="section-card">
            <div class="section-title">
              <span id="skillsTitle">Skills</span>
              <span class="small" id="skillsSubtitle">Core technical areas</span>
            </div>
            <div class="tag-row" id="skillsTags"></div>
          </div>

          <div class="section-card">
            <div class="section-title">
              <span id="projectsTitle">Projects</span>
              <span class="small" id="projectsSubtitle">Selected work</span>
            </div>
            <div id="projectsList"></div>
          </div>
        </div>
        <div>
          <div class="section-card">
            <div class="section-title">
              <span id="certsTitle">Certificates</span>
              <span class="small" id="certsSubtitle">Courses & achievements</span>
            </div>
            <div id="certsList"></div>
          </div>
          <div class="section-card" id="contactSection">
            <div class="section-title">
              <span id="contactTitle">Contact</span>
            </div>
            <div class="list-item">
              <span class="label">Email:</span>
              <span id="contactEmail"></span>
            </div>
            <div class="list-item">
              <span class="label">Phone:</span>
              <span id="contactPhone"></span>
            </div>
            <div class="list-item">
              <span class="label">LinkedIn:</span>
              <a href="#" id="contactLinkedIn" class="link" target="_blank" rel="noreferrer">Open</a>
            </div>
            <div class="list-item">
              <span class="label">GitHub:</span>
              <a href="#" id="contactGitHub" class="link" target="_blank" rel="noreferrer">Open</a>
            </div>
          </div>
        </div>
      </div>

      <div class="footer">
        <span id="footerText">© <span id="year"></span> Saher. Built for internship & job applications.</span>
      </div>
    </div>
  </div>

  <!-- ADMIN VIEW -->
  <div id="adminView">
    <div class="admin-wrap">
      <div id="adminLogin" class="login-box">
        <h2>Admin access</h2>
        <p style="font-size:13px;color:#9ca3af;">اكتب كلمة السر عشان تعدّل البروفايل (محفوظة في الكود مش آمنة 100٪).</p>
        <input type="password" id="adminPassword" placeholder="Admin password" />
        <button class="btn btn-primary" style="margin-top:12px;" id="btnAdminLogin">Login</button>
        <div class="login-error" id="adminLoginError"></div>
      </div>

      <div id="adminForm" style="display:none;">
        <div class="admin-header">
          <h2>Admin panel – Saher profile</h2>
          <div class="badge">Any save here → Firebase → يظهر للجميع</div>
        </div>

        <div class="admin-grid">
          <div class="section-card">
            <div class="section-title"><span>Basic info</span></div>
            <div class="field">
              <label>Name (EN)</label>
              <input id="nameEnInput" />
            </div>
            <div class="field">
              <label>Title (EN)</label>
              <input id="titleEnInput" />
            </div>
            <div class="field">
              <label>About (EN) — each line = one paragraph</label>
              <textarea id="aboutEnInput"></textarea>
            </div>

            <div class="field">
              <label>Name (AR)</label>
              <input id="nameArInput" />
            </div>
            <div class="field">
              <label>Title (AR)</label>
              <input id="titleArInput" />
            </div>
            <div class="field">
              <label>About (AR) — كل سطر فقرة</label>
              <textarea id="aboutArInput"></textarea>
            </div>

            <div class="field">
              <label>Photo URL (مثلاً profile.jpg)</label>
              <input id="photoUrlInput" />
              <div class="note">حط اسم الصورة في نفس الفولدر أو لينك مباشر.</div>
            </div>

            <div class="field">
              <label>Email</label>
              <input id="emailInput" />
            </div>
            <div class="field">
              <label>Phone</label>
              <input id="phoneInput" />
            </div>
            <div class="field">
              <label>LinkedIn URL</label>
              <input id="linkedinInput" />
            </div>
            <div class="field">
              <label>GitHub URL</label>
              <input id="githubInput" />
            </div>
            <div class="field">
              <label>CV URL (PDF)</label>
              <input id="cvUrlInput" />
              <div class="note">ارفع الـ CV على GitHub أو أي مكان وحط اللينك هنا.</div>
            </div>
          </div>

          <div class="section-card">
            <div class="section-title"><span>Projects</span></div>
            <div class="field">
              <label>Projects list</label>
              <textarea id="projectsInput" placeholder="Title | short description | optional link"></textarea>
              <div class="note">كل مشروع في سطر: <br>العنوان | وصف قصير | لينك (اختياري)</div>
            </div>

            <div class="section-title" style="margin-top:12px;"><span>Certificates</span></div>
            <div class="field">
              <label>Certificates list</label>
              <textarea id="certsInput" placeholder="Name | Issuer | Year | optional link"></textarea>
              <div class="note">كل شهادة في سطر: <br>الاسم | الجهة | السنة | لينك (اختياري)</div>
            </div>

            <div class="field" style="margin-top:12px;">
              <button class="btn btn-primary" id="btnSaveProfile">Save to Firebase</button>
              <button class="btn btn-ghost" id="btnReloadProfile" style="margin-left:8px;">Reload</button>
              <div class="note">بعد الحفظ افتح البروفايل العادي في تاب جديدة وتأكد إن كل حاجة اتحدّثت.</div>
              <div class="danger" id="adminMessage"></div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // -----------------------------------
    //  Firebase CONFIG  (حط بياناتك هنا)
    // -----------------------------------
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY_HERE",
      authDomain: "YOUR_AUTH_DOMAIN_HERE",
      projectId: "YOUR_PROJECT_ID_HERE",
      storageBucket: "YOUR_STORAGE_BUCKET_HERE",
      messagingSenderId: "YOUR_SENDER_ID_HERE",
      appId: "YOUR_APP_ID_HERE"
      // measurementId: "OPTIONAL"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const COLLECTION = 'profiles';
    const DOC_ID = 'saher_main_profile';

    // -----------------------------------
    //  DATA MODEL (default values)
    // -----------------------------------
    const defaultProfile = {
      lang: 'en',
      basic: {
        nameEn: "Saher Ehab Ahmed Marzouk",
        titleEn: "Telecommunications and Networks Engineer",
        aboutEn: [
          "Telecommunications and Networks Engineer, interested in networking and cybersecurity with a continuous drive to develop technical skills.",
          "Skilled in programming and familiar with security fundamentals and penetration testing, with knowledge of CEH.",
          "Seeking an internship or entry-level opportunity to gain hands-on experience and contribute to real-world projects within a team."
        ],
        nameAr: "ساهر إيهاب أحمد مرزوق",
        titleAr: "مهندس اتصالات وشبكات",
        aboutAr: [
          "مهندس اتصالات وشبكات مهتم بمجال الشبكات والأمن السيبراني ولديه شغف دائم بتطوير المهارات التقنية.",
          "لدي مهارات برمجية ومعرفة بأساسيات الأمن واختبار الاختراق مع إلمام بمحتوى CEH.",
          "أبحث عن تدريب أو فرصة مبتدئة لاكتساب خبرة عملية والمساهمة في مشاريع حقيقية ضمن فريق."
        ],
        photoUrl: "profile.jpg"
      },
      contact: {
        email: "sahermarzouk655@gmail.com",
        phone: "",
        linkedin: "https://www.linkedin.com/in/%D8%B3%D8%A7%D9%87%D8%B1-%D8%A3%D9%8A%D9%87%D8%A7%D8%A8-58a43a270/?locale=en-US",
        github: "https://github.com/",
        cvUrl: ""
      },
      skills: [
        "Routing & Switching",
        "TCP/IP",
        "Subnetting",
        "LAN/WAN",
        "OSI Model",
        "Network Troubleshooting",
        "Linux Basics",
        "Security Fundamentals",
        "Penetration Testing Basics",
        "CEH Knowledge",
        "Python",
        "C / C++"
      ],
      projects: [
        { title: "Example Project 1", desc: "Short description of the project.", link: "" }
      ],
      certificates: [
        { name: "Example Certificate", issuer: "Platform", year: "2025", link: "" }
      ]
    };

    let profile = JSON.parse(JSON.stringify(defaultProfile));
    const LOCAL_KEY = 'saherPortfolioProfile_v1';
    const ADMIN_PASSWORD = 'saher.20230289'; // تقدر تغيّرها، بس خلي بالك إنها باينة في الكود

    function $(id){return document.getElementById(id);}

    function parseProjects(text){
      return text.split('\n').map(l=>l.trim()).filter(Boolean).map(line=>{
        const parts=line.split('|');
        return {
          title:(parts[0]||'').trim(),
          desc:(parts[1]||'').trim(),
          link:(parts[2]||'').trim()
        };
      });
    }
    function parseCerts(text){
      return text.split('\n').map(l=>l.trim()).filter(Boolean).map(line=>{
        const parts=line.split('|');
        return {
          name:(parts[0]||'').trim(),
          issuer:(parts[1]||'').trim(),
          year:(parts[2]||'').trim(),
          link:(parts[3]||'').trim()
        };
      });
    }
    function projectsToText(list){
      return (list||[]).map(p=>[p.title,p.desc,p.link].filter(Boolean).join(' | ')).join('\n');
    }
    function certsToText(list){
      return (list||[]).map(c=>[c.name,c.issuer,c.year,c.link].filter(Boolean).join(' | ')).join('\n');
    }

    // -------- Firestore load/save ----------
    async function loadProfileFromFirestore(){
      try{
        const doc = await db.collection(COLLECTION).doc(DOC_ID).get();
        if(doc.exists){
          return doc.data();
        }else{
          const saved = localStorage.getItem(LOCAL_KEY);
          if(saved) return JSON.parse(saved);
          return defaultProfile;
        }
      }catch(e){
        console.error('Firestore load error', e);
        const saved = localStorage.getItem(LOCAL_KEY);
        if(saved) return JSON.parse(saved);
        return defaultProfile;
      }
    }

    async function saveProfileToFirestore(){
      try{
        await db.collection(COLLECTION).doc(DOC_ID).set(profile);
        localStorage.setItem(LOCAL_KEY, JSON.stringify(profile));
        $('adminMessage').textContent = "تم الحفظ في Firebase ✅";
      }catch(e){
        console.error('Firestore save error', e);
        $('adminMessage').textContent = "خطأ أثناء الحفظ على Firebase، راجع الـ console.";
      }
    }

    // ---------- RENDER PUBLIC VIEW ----------
    function renderPublic(lang){
      const b = profile.basic;
      const c = profile.contact;
      const aboutLines = lang==='ar' ? b.aboutAr : b.aboutEn;
      const nameText = lang==='ar' ? b.nameAr : b.nameEn;
      const titleText = lang==='ar' ? b.titleAr : b.titleEn;

      $('nameText').textContent = nameText || '';
      $('titleText').textContent = titleText || '';
      $('aboutText').innerHTML = (aboutLines||[]).map(p=>'<p>'+p+'</p>').join('');
      $('emailText').textContent = c.email || '';
      $('phoneText').textContent = c.phone || '';

      $('contactEmail').textContent = c.email || '';
      $('contactPhone').textContent = c.phone || '';
      $('contactLinkedIn').href = c.linkedin || '#';
      $('contactGitHub').href = c.github || '#';

      const img = $('profilePhoto');
      if(c.photoUrl || b.photoUrl){
        img.style.display='block';
        img.src = c.photoUrl || b.photoUrl;
      }

      // Skills
      $('skillsTags').innerHTML = (profile.skills||[]).map(s=>{
        return '<div class="tag">'+s+'</div>';
      }).join('');

      // Projects
      $('projectsList').innerHTML = (profile.projects||[]).map(p=>{
        const linkHtml = p.link ? '<a class="link" href="'+p.link+'" target="_blank" rel="noreferrer">Link</a>' : '';
        return '<div class="list-item"><span class="label">'+p.title+
          ':</span> '+p.desc+' '+linkHtml+'</div>';
      }).join('') || '<div class="list-item" style="color:#9ca3af;">No projects yet.</div>';

      // Certificates
      $('certsList').innerHTML = (profile.certificates||[]).map(cer=>{
        const linkHtml = cer.link ? '<a class="link" href="'+cer.link+'" target="_blank" rel="noreferrer">Link</a>' : '';
        return '<div class="list-item"><span class="label">'+cer.name+
          '</span> – '+cer.issuer+' ('+cer.year+') '+linkHtml+'</div>';
      }).join('') || '<div class="list-item" style="color:#9ca3af;">No certificates yet.</div>';

      // Texts EN/AR
      if(lang==='ar'){
        document.body.dir = 'rtl';
        $('roleLabel').textContent = "اتصالات وشبكات – أمن سيبراني";
        $('skillsTitle').textContent = "المهارات";
        $('skillsSubtitle').textContent = "المجالات الأساسية";
        $('projectsTitle').textContent = "المشاريع";
        $('projectsSubtitle').textContent = "نماذج من الأعمال";
        $('certsTitle').textContent = "الشهادات";
        $('certsSubtitle').textContent = "الدورات والاعتمادات";
        $('contactTitle').textContent = "التواصل";
        $('footerText').innerHTML = "© <span id='year'></span> "+nameText+" – ملف تعريفي للتقديم على التدريب والوظائف.";
      }else{
        document.body.dir = 'ltr';
        $('roleLabel').textContent = "Telecom • Networking • Cybersecurity";
        $('skillsTitle').textContent = "Skills";
        $('skillsSubtitle').textContent = "Core technical areas";
        $('projectsTitle').textContent = "Projects";
        $('projectsSubtitle').textContent = "Selected work";
        $('certsTitle').textContent = "Certificates";
        $('certsSubtitle').textContent = "Courses & achievements";
        $('contactTitle').textContent = "Contact";
        $('footerText').innerHTML = "© <span id='year'></span> "+nameText+" – Portfolio for internships & jobs.";
      }
      $('year').textContent = new Date().getFullYear();
    }

    // ---------- ADMIN FORM ----------
    function fillAdminForm(){
      const b = profile.basic;
      const c = profile.contact;

      $('nameEnInput').value = b.nameEn || '';
      $('titleEnInput').value = b.titleEn || '';
      $('aboutEnInput').value = (b.aboutEn||[]).join('\n');

      $('nameArInput').value = b.nameAr || '';
      $('titleArInput').value = b.titleAr || '';
      $('aboutArInput').value = (b.aboutAr||[]).join('\n');

      $('photoUrlInput').value = b.photoUrl || '';

      $('emailInput').value = c.email || '';
      $('phoneInput').value = c.phone || '';
      $('linkedinInput').value = c.linkedin || '';
      $('githubInput').value = c.github || '';
      $('cvUrlInput').value = c.cvUrl || '';

      $('projectsInput').value = projectsToText(profile.projects||[]);
      $('certsInput').value = certsToText(profile.certificates||[]);
      $('adminMessage').textContent = '';
    }

    function readAdminForm(){
      const b = profile.basic;
      const c = profile.contact;

      b.nameEn = $('nameEnInput').value.trim();
      b.titleEn = $('titleEnInput').value.trim();
      b.aboutEn = $('aboutEnInput').value.split('\n').map(l=>l.trim()).filter(Boolean);

      b.nameAr = $('nameArInput').value.trim();
      b.titleAr = $('titleArInput').value.trim();
      b.aboutAr = $('aboutArInput').value.split('\n').map(l=>l.trim()).filter(Boolean);

      b.photoUrl = $('photoUrlInput').value.trim();

      c.email = $('emailInput').value.trim();
      c.phone = $('phoneInput').value.trim();
      c.linkedin = $('linkedinInput').value.trim();
      c.github = $('githubInput').value.trim();
      c.cvUrl = $('cvUrlInput').value.trim();

      profile.projects = parseProjects($('projectsInput').value);
      profile.certificates = parseCerts($('certsInput').value);
    }

    // ---------- EVENT SETUP ----------
    function setupPublicEvents(){
      $('btnCv').onclick = function(){
        const url = profile.contact.cvUrl;
        if(url){
          window.open(url, '_blank');
        }else{
          alert('CV link not set yet. Add it from admin.');
        }
      };
      $('btnContactScroll').onclick = function(){
        document.getElementById('contactSection').scrollIntoView({behavior:'smooth'});
      };
      $('btnLangEn').onclick = function(){
        profile.lang = 'en';
        $('btnLangEn').classList.add('active');
        $('btnLangAr').classList.remove('active');
        renderPublic('en');
      };
      $('btnLangAr').onclick = function(){
        profile.lang = 'ar';
        $('btnLangAr').classList.add('active');
        $('btnLangEn').classList.remove('active');
        renderPublic('ar');
      };
    }

    function setupAdminEvents(){
      $('btnSaveProfile').onclick = async function(){
        readAdminForm();
        await saveProfileToFirestore();
      };
      $('btnReloadProfile').onclick = async function(){
        $('adminMessage').textContent = 'جارى التحميل من Firebase...';
        profile = await loadProfileFromFirestore();
        fillAdminForm();
        $('adminMessage').textContent = 'تم إعادة التحميل من Firebase.';
      };
      $('btnAdminLogin').onclick = function(){
        const pass = $('adminPassword').value;
        if(pass === ADMIN_PASSWORD){
          $('adminLoginError').textContent = '';
          $('adminLogin').style.display = 'none';
          $('adminForm').style.display = 'block';
          fillAdminForm();
        }else{
          $('adminLoginError').textContent = 'كلمة السر غير صحيحة.';
        }
      };
    }

    // ---------- INIT ----------
    document.addEventListener('DOMContentLoaded', async function(){
      const search = window.location.search.toLowerCase();
      const hash = window.location.hash.toLowerCase();
      const isAdmin = search.indexOf('admin') !== -1 || hash.indexOf('admin') !== -1;

      profile = await loadProfileFromFirestore();

      if(isAdmin){
        document.getElementById('profileView').style.display = 'none';
        document.getElementById('adminView').style.display = 'block';
        setupAdminEvents();
      }else{
        document.getElementById('profileView').style.display = 'block';
        document.getElementById('adminView').style.display = 'none';
        setupPublicEvents();
        const lang = profile.lang || 'en';
        if(lang === 'ar'){
          $('btnLangAr').classList.add('active');
          $('btnLangEn').classList.remove('active');
        }
        renderPublic(lang);
      }
    });
  </script>
</body>
</html>
